(this["webpackJsonpreact-express-starter"]=this["webpackJsonpreact-express-starter"]||[]).push([[0],{104:function(e,t,n){},105:function(e,t,n){},240:function(e,t){},244:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(93),o=n.n(c),l=(n(104),n(105),n(40)),u=n.n(l),i=n(94),s=n(5),m=function(e){var t=e.username,n=e.handleUsernameChange,a=e.roomName,c=e.handleRoomNameChange,o=e.handleSubmit;return r.a.createElement("form",{onSubmit:o},r.a.createElement("h2",null,"Enter a room"),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"name"},"Your Name"),r.a.createElement("input",{type:"text",id:"field",value:t,onChange:n,required:!0})),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"room"},"Room Name"),r.a.createElement("input",{type:"text",id:"room",value:a,onChange:c}),"Share this with your partner"),r.a.createElement("button",{type:"submit"},"Submit"))},d=n(16),f=n(95),b=n.n(f),p=function(e){var t=e.participant,n=Object(a.useState)([]),c=Object(s.a)(n,2),o=c[0],l=c[1],u=Object(a.useState)([]),i=Object(s.a)(u,2),m=i[0],f=i[1],b=Object(a.useRef)(),p=Object(a.useRef)(),h=function(e){return Array.from(e.values()).map((function(e){return e.track})).filter((function(e){return null!==e}))};return Object(a.useEffect)((function(){l(h(t.videoTracks)),f(h(t.audioTracks));return t.on("trackSubscribed",(function(e){"video"===e.kind?l((function(t){return[].concat(Object(d.a)(t),[e])})):"audio"===e.kind&&f((function(t){return[].concat(Object(d.a)(t),[e])}))})),t.on("trackUnsubscribed",(function(e){"video"===e.kind?l((function(t){return t.filter((function(t){return t!==e}))})):"audio"===e.kind&&f((function(t){return t.filter((function(t){return t!==e}))}))})),function(){l([]),f([]),t.removeAllListeners()}}),[t]),Object(a.useEffect)((function(){var e=o[0];if(e)return e.attach(b.current),function(){e.detach()}}),[o]),Object(a.useEffect)((function(){var e=m[0];if(e)return e.attach(p.current),function(){e.detach()}}),[m]),r.a.createElement("div",{className:"participant"},r.a.createElement("h3",null,t.identity),r.a.createElement("video",{ref:b,autoPlay:!0}),r.a.createElement("audio",{ref:p,autoPlay:!0,muted:!0}))},h=function(e){var t=e.roomName,n=e.token,c=(e.handleLogout,e.setTalk),o=e.talk,l=Object(a.useState)(null),u=Object(s.a)(l,2),i=u[0],m=u[1],f=Object(a.useState)([]),h=Object(s.a)(f,2),k=h[0],E=h[1];Object(a.useEffect)((function(){var e=function(e){E((function(t){return[].concat(Object(d.a)(t),[e])}))},a=function(e){E((function(t){return t.filter((function(t){return t!==e}))}))};return b.a.connect(n,{name:t}).then((function(t){m(t),t.on("participantConnected",e),t.on("participantDisconnected",a),t.participants.forEach(e)})),function(){m((function(e){return e&&"connected"===e.localParticipant.state?(e.localParticipant.tracks.forEach((function(e){e.track.stop()})),e.disconnect(),null):e}))}}),[t,n]);var v=k.map((function(e){return r.a.createElement(p,{key:e.sid,participant:e})}));return r.a.createElement("div",{className:"room"},r.a.createElement("h2",null,"Room: ",t),r.a.createElement("div",{className:"local-participant"},i?r.a.createElement(p,{key:i.localParticipant.sid,participant:i.localParticipant}):""),r.a.createElement("button",{onClick:function(){c(!o)},style:{margin:"0 auto",display:"block"}},"Hangup"),r.a.createElement("h3",null,"Remote Participants"),r.a.createElement("div",{className:"remote-participants"},v))},k=n(96),E=n(97),v=n(3),j=n.n(v),O=new(function(){function e(){Object(k.a)(this,e)}return Object(E.a)(e,[{key:"isSupported",value:function(){return null!==j.a}},{key:"start",value:function(){j.a&&j.a.start()}},{key:"abort",value:function(){j.a&&j.a.abort()}},{key:"resume",value:function(){j.a&&j.a.resume()}},{key:"addCommands",value:function(e){j.a&&j.a.addCommands(e)}},{key:"addCallback",value:function(e,t){j.a&&(j.a.addCallback("start",(function(t){return e("on")})),j.a.addCallback("soundstart",(function(t){return e("listening")})),j.a.addCallback("end",(function(t){return e("off")})),j.a.addCallback("error",(function(t){return e(t.error)})),j.a.addCallback("errorNetwork",(function(t){return e("network error")})),j.a.addCallback("errorPermissionBlocked",(function(t){return e("permission blocked")})),j.a.addCallback("errorPermissionDenied",(function(t){return e("permission denied")})),j.a.addCallback("result",(function(e){return t(e)})))}}]),e}()),y=n(98),C=n.n(y),g=function(e){var t=e.roomName,n=e.token,c=e.handleLogout,o=e.username,l=Object(a.useState)(!1),u=Object(s.a)(l,2),i=u[0],m=u[1],d=Object(a.useState)(!1),f=Object(s.a)(d,2),b=f[0],p=f[1],k=Object(a.useState)(""),E=Object(s.a)(k,2),v=(E[0],E[1]),j=Object(a.useState)(""),y=Object(s.a)(j,2),g=(y[0],y[1]),S=Object(a.useState)([]),w=Object(s.a)(S,2),N=w[0],P=w[1],R=Object(a.useState)([]),x=Object(s.a)(R,2),T=(x[0],x[1]),D=Object(a.useState)(C()("http://localhost:5000")),H=Object(s.a)(D,2),L=H[0];H[1];Object(a.useEffect)((function(){N[0];var e={Hey:function(){Y()},Yes:function(){p(!1),m(!0)},Hangup:function(){B()}};O.addCommands(e),O.start(),L.emit("register",{data:{roomName:t,username:o}}),L.on("user-registered",(function(e){T(e.users);var t=e.users.filter((function(e){return e!=o}));P(t)})),L.on("calls",(function(e){e.data.caller!=o&&(p(!0),v(e.data.roomName),g(e.data.caller))}))}),[]);var Y=function(){m(!0);var e=N[0]||"";L.emit("call",{data:{roomName:t,otherUser:e,caller:o}}),p(!1)},B=function(){m(!1),p(!1)};return r.a.createElement("div",{class:"container-fluid"},r.a.createElement("div",{class:"container",style:{backgroundColor:"#DCD5CD",paddingBottom:"5px"}},0==N.length?r.a.createElement("div",null,r.a.createElement("h3",null,"This desk is empty right now!"),r.a.createElement("br",null),r.a.createElement("p",null,"Ask your partner to join the desk ",r.a.createElement("em",null,t),".")):null,!i&&N.length>0?r.a.createElement("div",null,r.a.createElement("h3",null," You are on desk ",r.a.createElement("em",null,t)," with :",N.map((function(e,t){return" "+e+","}))),r.a.createElement("br",null),r.a.createElement("p",null," Say ",r.a.createElement("em",null,'"Hey!"')," aloud to talk to them or press the button below. \ud83d\udc47\ud83c\udffd"),!0!==b?r.a.createElement("button",{onClick:function(){return Y()}},"Hey!"):null):null),!0!==b||i?null:r.a.createElement("div",{style:{backgroundColor:"red"}},r.a.createElement("h3",null,"Incoming Call!"),r.a.createElement("h4",null,'Say "Yes" to pickup!'),r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){p(!1),m(!0)}},"Yes!"),r.a.createElement("a",{onClick:function(){return p(!1)}},"Close")),r.a.createElement("a",{onClick:c,style:{right:20,top:10,position:"absolute"}},"Log out"),i?r.a.createElement(h,{roomName:t,token:n,handleLogout:c,talk:i,setTalk:m}):null)},S=n(243),w=function(){var e=new S,t=Object(a.useState)(""),n=Object(s.a)(t,2),c=n[0],o=n[1],l=Object(a.useState)(e.word({syllables:2})),d=Object(s.a)(l,2),f=d[0],b=d[1],p=Object(a.useState)(null),h=Object(s.a)(p,2),k=h[0],E=h[1],v=Object(a.useCallback)((function(e){o(e.target.value)}),[]),j=Object(a.useCallback)((function(e){b(e.target.value)}),[]),O=Object(a.useCallback)(function(){var e=Object(i.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("http://localhost:5000/token-room",{method:"POST",body:JSON.stringify({identity:c,room:f}),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}));case 3:n=e.sent,E(n.token);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[f,c]),y=Object(a.useCallback)((function(e){E(null)}),[]);return k?r.a.createElement(g,{roomName:f,token:k,handleLogout:y,username:c}):r.a.createElement(m,{username:c,roomName:f,handleUsernameChange:v,handleRoomNameChange:j,handleSubmit:O})},N=function(){return r.a.createElement("div",{className:"app"},r.a.createElement("header",null,r.a.createElement("h1",null,"\ud83e\udd83 Hellin' Worki")),r.a.createElement("main",null,r.a.createElement(w,null)),r.a.createElement("footer",null,r.a.createElement("p",null,"Made with"," ",r.a.createElement("span",{role:"img","aria-label":"React"},"\u269b")," ","by ",r.a.createElement("a",{href:"https://twitter.com/_Rohan_Sawant_"},"Rohan Sawant"))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(N,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},99:function(e,t,n){e.exports=n(244)}},[[99,1,2]]]);
//# sourceMappingURL=main.cde9ccf9.chunk.js.map